# ì‹ ìš©ì¹´ë“œ ì‚¬ìš©ì ì„¸ê·¸ë¨¼íŠ¸ ë¶„ë¥˜ í”„ë¡œì íŠ¸ (Credit Card User Segmentation)

ì´ í”„ë¡œì íŠ¸ëŠ” ëŒ€ìš©ëŸ‰ ì‹ ìš©ì¹´ë“œ ì‚¬ìš© ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ì „ì²˜ë¦¬í•˜ì—¬, ì‚¬ìš©ìì˜ íŠ¹ì„±ì— ë”°ë¼ 5ê°œ ì„¸ê·¸ë¨¼íŠ¸(A~E)ë¡œ ë¶„ë¥˜í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

## ë©”ì¸ ì½”ë“œ ë° ë°œí‘œ ìë£Œ
* **ë©”ì¸ ì½”ë“œ** : /main/20260213 ì‹ ìš©ì¹´ë“œì¡° ë©”ì¸ ì½”ë“œ íŒŒì¼.ipynb
* **ë°œí‘œ í”„ë ˆì  í…Œì´ì…˜** : /main/20260213 ì‹ ìš©ì¹´ë“œì¡° í”„ë ˆì  í…Œì´ì…˜.pptx

## ì¡°ì›
* **ì´ê±´ìš±** : íŒŒì¼ì„ ì „ì²˜ë¦¬í•œ ë’¤ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜ ë§Œë“¤ì–´ì£¼ê¸°, ì „ì²˜ë¦¬ ë° í”¼ì²˜ ì—”ì§€ë‹ˆì–´ë§ í•˜ê¸°, ì¡°ì›ë“¤ì´ ê°ì ì‘ì—…í•œ íŒŒì¼ì„ í†µí•©í•˜ê¸°
* **ì–‘ë™ë…•** : ì½”ë“œ ë¦¬ë·°, ê¸°íƒ€ ì „ì²˜ë¦¬ ë° ëª¨ë¸ë§
* **ì•ˆë„ê²¸** : ëª¨ë¸ ë¶„ì„ ë° ì½”ë“œ ë¦¬ë·°
* **ìœ ì°½ì—½** : ì‹œìƒì ì½”ë“œ ë¦¬ë·° ë° í”¼ì³ ì—”ì§€ë‹ˆì–´ë§

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”
* **ë°ì´í„°ì…‹**: íšŒì›ì •ë³´, ì‹ ìš©ì •ë³´, ìŠ¹ì¸ë§¤ì¶œì •ë³´ ë“± ë‹¤ì–‘í•œ ë²”ì£¼ì˜ ëŒ€ê·œëª¨ ë°ì´í„° (Parquet í˜•ì‹)
* **ê·œëª¨**: ì•½ 240ë§Œ ê±´ì˜ ì‹ ìš©ì¹´ë“œ ì´ìš©ì ë°ì´í„°
* **ëª©ì **: ì‚¬ìš©ì íŠ¹ì„± ë¶„ì„ì„ í†µí•œ 5ê°œ ê·¸ë£¹(Segment A~E) ì˜ˆì¸¡
* **ì¶œì²˜**: [Dacon ì‹ ìš©ì¹´ë“œ ì„¸ê·¸ë¨¼íŠ¸ ê²½ì§„ëŒ€íšŒ](https://dacon.io/competitions/official/236460/overview/description)
* **ì£¼ìš” íŠ¹ì§•**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ìµœì í™” ë° ì•™ìƒë¸” ëª¨ë¸ë§

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ
* **ì–¸ì–´**: Python 3.8+
* **ë°ì´í„° ì²˜ë¦¬**: Pandas, NumPy, PyArrow
* **ì‹œê°í™”**: Matplotlib, Seaborn
* **ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸**: XGBoost, LightGBM, CatBoost
* **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”**: Optuna
* **ë¶ˆê· í˜• ì²˜ë¦¬**: SMOTE (Imbalanced-Learn)
* **í•˜ë“œì›¨ì–´**: GPU (CUDA) ê°€ì† ì§€ì›

## ğŸš€ í”„ë¡œì íŠ¸ ì£¼ìš” ë‹¨ê³„

### 1. ë°ì´í„° ë¡œë“œ ë° ë³‘í•©
* ì—¬ëŸ¬ í´ë”ì— ë¶„ì‚°ëœ Parquet íŒŒì¼ì„ íš¨ìœ¨ì ìœ¼ë¡œ ë¡œë“œí•˜ê³  í†µí•©í•˜ëŠ” `make_df()` í•¨ìˆ˜ë¥¼ êµ¬í˜„
* ê¸°ì¤€ë…„ì›”ê³¼ ID ê¸°ì¤€ìœ¼ë¡œ 8ê°œ ë²”ì£¼ì˜ ë°ì´í„° í†µí•©

### 2. ë°ì´í„° ìµœì í™” (Memory Optimization)
* ì•½ 240ë§Œ ê±´ì˜ ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•´ ìˆ˜ì¹˜í˜• ë°ì´í„°ë¥¼ ì ì ˆí•œ íƒ€ì…ìœ¼ë¡œ ë‹¤ìš´ìºìŠ¤íŒ…
* int64/float64 â†’ int32/float32ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 50%+ ì ˆê°

### 3. íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ (EDA)
* ì„¸ê·¸ë¨¼íŠ¸ë³„ ë¶„í¬ ë° ì£¼ìš” ë³€ìˆ˜ ì‹œê°í™”
* ìƒê´€ê³„ìˆ˜ ë¶„ì„ì„ í†µí•œ ì˜í–¥ë ¥ ìˆëŠ” ë³€ìˆ˜ íŒŒì•…
* ì„¸ê·¸ë¨¼íŠ¸ë³„ ì´ìƒì¹˜ íƒì§€ ë° ì²˜ë¦¬

### 4. ì „ì²˜ë¦¬ (Data Preprocessing)
* ë¶ˆê· í˜• ì»¬ëŸ¼ ì œê±° (95% ì´ìƒì˜ ê°’ì´ í¸ì¤‘)
* ê²°ì¸¡ì¹˜ 50% ì´ˆê³¼ ì»¬ëŸ¼ ì‚­ì œ
* ìµœë¹ˆê°’ì„ ì´ìš©í•œ ê²°ì¸¡ì¹˜ ì±„ìš°ê¸°

### 5. íŠ¹ì„± ê³µí•™ (Feature Engineering)  
* **ë„ë©”ì¸ ê¸°ë°˜ íŒŒìƒë³€ìˆ˜**: ê¸ˆìœµ ë„ë©”ì¸ ì§€ì‹ í™œìš©í•œ 50+ ê°œì˜ íŒŒìƒë³€ìˆ˜ ìƒì„±
* **ì´ì§„í™”**: ë²”ì£¼í˜• ë³€ìˆ˜ë¥¼ 0/1ë¡œ ë³€í™˜
* **ë§¤í•‘**: ì„œìˆ˜í˜• ë²”ì£¼ë¥¼ ìˆ˜ì¹˜ë¡œ ë³€í™˜
* **íŒŒìƒë³€ìˆ˜**: í•œë„ë¹„ìœ¨, ì†Œë¹„ì„±í–¥, ì•ˆì •ì„± ì§€í‘œ ë“± ìƒì„±
* **ì—…ì¢… ì ìˆ˜ ì‹œìŠ¤í…œ**: ì„¸ê·¸ë¨¼íŠ¸ì™€ì˜ ìƒê´€ê´€ê³„ ê¸°ë°˜ ê°€ì¤‘ ì ìˆ˜ ì„¤ê³„

### 6. íŠ¹ì„± ì„ íƒ (Feature Selection)
* XGBoost Feature Importance ê¸°ë°˜ìœ¼ë¡œ ìƒìœ„ 450ê°œ ë³€ìˆ˜ ì„ íƒ
* 450ê°œ ë³€ìˆ˜ë¡œ ì‹ í˜¸/ë…¸ì´ì¦ˆ ìµœì  ê· í˜• ë‹¬ì„± (ì‹¤ì¦)

### 7. ëª¨ë¸ êµ¬ì¶• (Model Building)
* XGBoost, LightGBM, CatBoost ì„¸ ê°€ì§€ ë¶€ìŠ¤íŒ… ëª¨ë¸ êµ¬ì¶•
* SMOTEë¥¼ í†µí•œ í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬
* Balanced Class Weight ì ìš©

### 8. í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” (Hyperparameter Tuning)
* Optunaë¥¼ í†µí•œ LightGBM íŒŒë¼ë¯¸í„° íƒìƒ‰
* ê° ëª¨ë¸ë³„ GPU ê°€ì† í™œìš©

### 9. ì•™ìƒë¸” ë° ì˜ˆì¸¡
* **Soft Voting ì•™ìƒë¸”**: ì„¸ ëª¨ë¸ì˜ ì˜ˆì¸¡ í™•ë¥ ì— ê°€ì¤‘ì¹˜ ë¶€ì—¬
  - XGBoost: 0.4
  - LightGBM: 0.3
  - CatBoost: 0.3

## ğŸ“‚ íŒŒì¼ êµ¬ì¡°
```
Credit-Card-Segment/
â”œâ”€â”€ readme.md                          # í”„ë¡œì íŠ¸ ë¬¸ì„œ (ì´ íŒŒì¼)
â”œâ”€â”€ merge_data.ipynb
â”œâ”€â”€ main/
â”‚   â”œâ”€â”€ 20260213 ì‹ ìš©ì¹´ë“œì¡° ë©”ì¸ ì½”ë“œ íŒŒì¼.ipynb    # â­ ë©”ì¸ ì½”ë“œ
â”‚   â””â”€â”€ ... (ë‹¤ëŸ‰ì˜ ì‹¤í—˜ íŒŒì¼ë“¤)
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ sample_submission.csv          # ì œì¶œ ì–‘ì‹
â”‚   â”œâ”€â”€ top450_features_XGB_balanced.csv  # ìƒìœ„ 450ê°œ ë³€ìˆ˜ ëª©ë¡
â”‚   â”œâ”€â”€ train/                         # í•™ìŠµ ë°ì´í„° (8 í´ë”ë³„)
â”‚   â”‚   â”œâ”€â”€ 1.íšŒì›ì •ë³´/
â”‚   â”‚   â”œâ”€â”€ 2.ì‹ ìš©ì •ë³´/
â”‚   â”‚   â”œâ”€â”€ ... (8ê°œ ë²”ì£¼)
â”‚   â”‚   â””â”€â”€ 8.ì„±ê³¼ì •ë³´/
â”‚   â””â”€â”€ test/                          # í…ŒìŠ¤íŠ¸ ë°ì´í„° (8 í´ë”ë³„)
â”œâ”€â”€ ADK/, LGW/, YCY/, YDY/            # íŒ€ì›ë³„ ì‘ì—… í´ë”
â””â”€â”€ LICENSE
```

---

## ğŸ“Š ë°ì´í„°ì…‹ì— ëŒ€í•œ ì†Œê°œ

### ë°ì´í„° êµ¬ì„± (8ê°œ ë²”ì£¼)
1. **íšŒì›ì •ë³´** (1.íšŒì›ì •ë³´)
   - ê³ ê°ì˜ ì¸êµ¬í†µê³„í•™ì  ì •ë³´ (ì—°ë ¹, ì„±ë³„, ì§ì—… ë“±)
   - ì…íšŒ ì •ë³´ ë° íƒˆíšŒ ì´ë ¥
   - ê±°ì£¼ì§€ ë° ì§ì¥ ì •ë³´

2. **ì‹ ìš©ì •ë³´** (2.ì‹ ìš©ì •ë³´)
   - ì‹ ìš©ë„ ë° ì‹ ìš©í•œë„ ì •ë³´
   - ì—°ì²´ ì´ë ¥ ë° ê°•ì œê°ì•¡ ë‚´ì—­
   - ì¹´ë“œë¡ , CA ì´ìš© ê°€ëŠ¥ ì—¬ë¶€

3. **ìŠ¹ì¸ë§¤ì¶œì •ë³´** (3.ìŠ¹ì¸ë§¤ì¶œì •ë³´)
   - ì¹´ë“œ ì‚¬ìš© ê±°ë˜ ë‚´ì—­ (ê²°ì œì¼, ê¸ˆì•¡ ë“±)
   - ê±°ë˜ ìœ í˜•ë³„ ë¶„ë¥˜ (ì¼ì‹œë¶ˆ, í• ë¶€ ë“±)

4. **ì²­êµ¬ì…ê¸ˆì •ë³´** (4.ì²­êµ¬ì…ê¸ˆì •ë³´)
   - ì›”ë³„ ì²­êµ¬ì•¡ ë° ì…ê¸ˆ í˜„í™©
   - ê²°ì œ ìˆ˜ë‹¨ë³„ í˜„í™©

5. **ì”ì•¡ì •ë³´** (5.ì”ì•¡ì •ë³´)
   - ì¹´ë“œ ì”ì•¡ (ì¼ì‹œë¶ˆ, í• ë¶€, CA ë“±)
   - í•œë„ ì†Œì§„ìœ¨

6. **ì±„ë„ì •ë³´** (6.ì±„ë„ì •ë³´)
   - ì›¹, ëª¨ë°”ì¼, ARS ë“± ì ‘ì ë³„ ë°©ë¬¸/ì¸ì… íšŸìˆ˜
   - ì±„ë„ë³„ ì´ìš© ë©”ë‰´ í˜„í™©

7. **ë§ˆì¼€íŒ…ì •ë³´** (7.ë§ˆì¼€íŒ…ì •ë³´)
   - ìº í˜ì¸ ì ‘ì´‰ ê±´ìˆ˜/ì¼ìˆ˜
   - í• ì¸, í˜œíƒ ì´ìš© í˜„í™©

8. **ì„±ê³¼ì •ë³´** (8.ì„±ê³¼ì •ë³´)
   - ì—…ì¢…ë³„ ì´ìš©ê¸ˆì•¡ (ì‡¼í•‘, êµí†µ, ì—¬ìœ , ë‚©ë¶€ ë“±)
   - ì„¸ë¶€ ì—…ì¢…ë³„ ì´ìš© í˜„í™©

### íƒ€ê²Ÿ ë³€ìˆ˜ (Segment)
5ê°œ ë“±ê¸‰ìœ¼ë¡œ ì‹ ìš©ì¹´ë“œ ì‚¬ìš©ìë¥¼ ë¶„ë¥˜:
- **A ë“±ê¸‰**: ê°€ì¥ ìš°ëŸ‰í•œ ê³ ê° (ë†’ì€ í•œë„, ì‹ ìš©ë„ ìš°ìˆ˜, í™œë°œí•œ ì´ìš©)
- **B ë“±ê¸‰**: ìš°ìˆ˜í•œ ê³ ê° (ì–‘í˜¸í•œ ì‹ ìš©ë„, í™œë°œí•œ ì¹´ë“œ ì´ìš©)
- **C ë“±ê¸‰**: ì¤‘ê°„ ìˆ˜ì¤€ì˜ ê³ ê°
- **D, E ë“±ê¸‰**: ìƒëŒ€ì ìœ¼ë¡œ ë‚®ì€ ì‹ ìš©ë„ ë° ì´ìš© í˜„í™©

---

## ğŸ” íƒìƒ‰ì  ë°ì´í„° ë¶„ì„ (Exploratory Data Analysis, EDA)

### ì£¼ìš” ë¶„ì„ ë‚´ìš©

1. **ì„¸ê·¸ë¨¼íŠ¸ë³„ ë¶„í¬ ë¶„ì„**
   - ê° ë“±ê¸‰ë³„ ê³ ê° ìˆ˜ íŒŒì•…
   - ì‹¬ê°í•œ í´ë˜ìŠ¤ ë¶ˆê· í˜• í™•ì¸: A(~5%), B(~10%), C/D/E(ë‚˜ë¨¸ì§€)
   - Box Plot, íˆìŠ¤í† ê·¸ë¨ì„ í†µí•œ ì‹œê°í™”

2. **í•µì‹¬ ë³€ìˆ˜ ë¶„ì„**
   - ì¹´ë“œì´ìš©í•œë„ê¸ˆì•¡: ë“±ê¸‰ë³„ ëª…í™•í•œ ì°¨ì´ (A > B > C > D > E)
   - í•œë„ ì†Œì§„ìœ¨: A(ë‚®ìŒ), B(ë†’ìŒ), C/D/E(ì¤‘ê°„~ë†’ìŒ)
   - íšŒì›_ì´ìš©ê°€ëŠ¥_ì ìˆ˜: A/Bì™€ C/D/Eë¥¼ êµ¬ë¶„í•˜ëŠ” í•µì‹¬ ì§€í‘œ

3. **ë³€ìˆ˜ ê°„ ê´€ê³„ ë¶„ì„**
   - ìƒê´€ê³„ìˆ˜ ë¶„ì„ìœ¼ë¡œ ì„¸ê·¸ë¨¼íŠ¸ì™€ì˜ correlation íŒŒì•…
   - Stacked Bar Chartë¡œ ì„¸ê·¸ë¨¼íŠ¸ë³„ íŠ¹ì„± ë¹„êµ
   - íˆíŠ¸ë§µì„ í†µí•œ í¬ë¡œìŠ¤í…Œì´ë¸” ë¶„ì„

4. **ì´ìƒì¹˜ íƒì§€**
   - IQR(Interquartile Range) ë°©ì‹ì„ í†µí•œ ì´ìƒì¹˜ ì‹ë³„
   - ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ ë‹¤ë¥¸ ì´ìƒì¹˜ ê¸°ì¤€ê°’ ì„¤ì •
   - í•œë„ê¸ˆì•¡ ê¸°ë°˜ Aë“±ê¸‰ ìµœì†Œê°’ ë„ì¶œ (ì•½ 17ë§Œì›)

---

## ğŸ”§ ì „ì²˜ë¦¬ (Data Preprocessing)

### 1. ë©”ëª¨ë¦¬ ìµœì í™” (Memory Optimization)
```python
def optimize_memory(df):
    # int64 â†’ ê°€ëŠ¥í•œ ê°€ì¥ ì‘ì€ ì •ìˆ˜í˜• (int8, int16, int32)
    # float64 â†’ float32ë¡œ ë³€í™˜í•˜ì—¬ ë©”ëª¨ë¦¬ 50%+ ì ˆê°
```
- 240ë§Œ ê±´ ëŒ€ê·œëª¨ ë°ì´í„° íš¨ìœ¨ì  ì²˜ë¦¬
- Parquet ì½ê¸° ì‹œ ë©”ëª¨ë¦¬ ì˜¤ë²„í—¤ë“œ ìµœì†Œí™”

### 2. íŒŒì¼ ë¡œë“œ ë° í†µí•©
- `make_df()` í•¨ìˆ˜ë¡œ 8ê°œ í´ë”ì˜ Parquet íŒŒì¼ ìë™ ë¡œë“œ
- ê¸°ì¤€ë…„ì›”(YYYYMM) ë° ID ê¸°ì¤€ìœ¼ë¡œ ë°ì´í„° ë³‘í•©
- Train/Test ë°ì´í„° ë¶„ë¦¬

### 3. ë°ì´í„° ì •ì œ (Data Cleaning)
- **ë¶ˆê· í˜• ì»¬ëŸ¼ ì œê±°**: í•œ ê°’ì´ 95% ì´ìƒì„ ì°¨ì§€í•˜ëŠ” ì»¬ëŸ¼ ì‚­ì œ
  ```python
  if df[col].value_counts(normalize=True).iloc[0] >= 0.95:
      # ì œê±° ëŒ€ìƒ
  ```
- **ê²°ì¸¡ì¹˜ 50% ì´ˆê³¼ ì»¬ëŸ¼ ì‚­ì œ**
  ```python
  if df[col].isnull().mean() > 0.5:
      # ì œê±° ëŒ€ìƒ
  ```
- **ê²°ì¸¡ì¹˜ ì²˜ë¦¬**: ìµœë¹ˆê°’(Mode)ìœ¼ë¡œ ì±„ìš°ê¸°
  ```python
  df[col] = df[col].fillna(df[col].mode()[0])
  ```
- **ë¬¸ìì—´ ë³€ìˆ˜ ì œê±°**: ë¶„ë¥˜ì— ë¬´ê´€í•œ ë³€ìˆ˜ ì‚­ì œ
  ```python
  df = df.drop(['ì—°ë ¹', '_2ìˆœìœ„ì‹ ìš©ì²´í¬êµ¬ë¶„', 'Life_Stage', ...])
  ```

### 4. Train/Test ë¶„ë¦¬
```python
train_df = df[df["Segment"].notna()]
test_df = df[df["Segment"].isna()]
```

---

## âš™ï¸ íŠ¹ì„± ê³µí•™ (Feature Engineering)

### 1. í´ë” 1 ê¸°ë°˜ íŒŒìƒë³€ìˆ˜ (ë„ë©”ì¸ ì§€ì‹ í™œìš©)

| íŒŒìƒë³€ìˆ˜ | ê³µì‹ | ì˜ë¯¸ | íƒ€ê²Ÿê³¼ì˜ correlation |
|---------|------|------|-----|
| **ì¹´ë“œ_ì¦‰ì‹œê°€ìš©_ë¹„ìœ¨** | ì†Œì§€ì¹´ë“œìˆ˜_ì´ìš©ê°€ëŠ¥ / (ì†Œì§€ì¹´ë“œìˆ˜_ìœ íš¨ + 1) | ì¦‰ì‹œ ì‚¬ìš© ê°€ëŠ¥í•œ ì¹´ë“œ ë¹„ìœ¨ | A/B êµ¬ë¶„ í•µì‹¬ |
| ëˆ„ì íƒˆíšŒë°€ë„ | íƒˆíšŒíšŸìˆ˜_ëˆ„ì  / (ìµœì¢…íƒˆíšŒí›„ê²½ê³¼ì›” + 1) | ê³ ê° í™œë™ì„± ë³€ë™ì„± | ìŒì˜ correlation |
| íƒˆíšŒì›ê²©ë„ | (íƒˆíšŒ_ëˆ„ì  - íƒˆíšŒ_1ë…„ì´ë‚´) / (íƒˆíšŒ_ëˆ„ì  + 1) | ìµœê·¼ í™œë™ ì—¬ë¶€ | A/B íƒ€ê²Ÿìš© |
| í™œë™ì•ˆì •ì„± | ìµœì¢…íƒˆíšŒí›„ê²½ê³¼ì›” / (ì…íšŒê²½ê³¼ê°œì›”ìˆ˜ + 1) | ê³ ê° ì•ˆì •ì„± ì§€í‘œ | ì–‘ì˜ correlation |
| ì”ì—¬ìœ íš¨ê°œì›”_ì‹¤ì´ìš© | ìµœì¢…ìœ íš¨ë…„ì›” - í˜„ì¬ (2026.02) | ì‹¤ì´ìš© ìœ íš¨ê¸°ê°„ | ì‹ ìš© ì‹ ë¢°ë„ |
| **íšŒì›_ì´ìš©ê°€ëŠ¥_ì ìˆ˜** | ì´ìš©ê°€ëŠ¥ + CAê°€ëŠ¥ + ì¹´ë“œë¡ ê°€ëŠ¥ | ìµœëŒ€ 3ì  (0~3) | **CatBoostê°€ ë§¤ìš° ì¤‘ì‹œ** |

### 2. ì‹ ìš©ì •ë³´ ë²”ì£¼ ì´ì§„í™” (Binarization)
- `ê°€ì…í†µì‹ íšŒì‚¬ì½”ë“œ` â†’ `ê°€ì…í†µì‹ íšŒì‚¬_Sì‚¬ì—¬ë¶€` (1 if Sí†µì‹ , 0 else)
- `ì§ì¥ì‹œë„ëª…` â†’ `ì§ì¥_ìˆ˜ë„ê¶Œì—¬ë¶€` (1 if ì„œìš¸/ê²½ê¸°, 0 else)
- `ê±°ì£¼ì‹œë„ëª…` â†’ `ê±°ì£¼ì§€_ìˆ˜ë„ê¶Œì—¬ë¶€` (1 if ì„œìš¸/ê²½ê¸°, 0 else)
- `RVì „í™˜ê°€ëŠ¥ì—¬ë¶€` â†’ `RV_ì „í™˜ê°€ëŠ¥ì—¬ë¶€_ì´ì§„` (1 if 'N', 0 else)
- `ì¹´ë“œë¡ ì´ìš©ì—¬ë¶€`: ì´ˆê¸°/ìµœì¢… ì¹´ë“œë¡  ì´ìš© ê²½ê³¼ì›” != 999 â†’ ì´ìš© (1/0)
- `RVì‹¤ì‚¬ìš©ì—¬ë¶€`: RVì•½ì •ì²­êµ¬ìœ¨ > 0 â†’ ì‹¤ì‚¬ìš© (1/0)
- ê°•ì œí•œë„ê°ì•¡ 2íšŒ ì´ìƒ, ìƒí–¥ê°€ëŠ¥ CAí•œë„ ê¸ˆì•¡ ë“±

### 3. ë²”ì£¼í˜• ë³€ìˆ˜ ë§¤í•‘ (Mapping)
```python
# ì˜ˆ: í• ì¸ê±´ìˆ˜ë¥¼ ìˆœì„œí˜• ìˆ˜ì¹˜ë¡œ ë³€í™˜
df['í• ì¸ê±´ìˆ˜_R3M'] = df['í• ì¸ê±´ìˆ˜_R3M'].map({
    '1íšŒ ì´ìƒ': 0, '10íšŒ ì´ìƒ': 1, '20íšŒ ì´ìƒ': 2, 
    '30íšŒ ì´ìƒ': 3, '40íšŒ ì´ìƒ': 4
})
```
- ìë°œí•œë„ê°ì•¡íšŸìˆ˜ ('0íšŒ'â†’0, '1íšŒ'â†’1, '2íšŒ'â†’2)
- ë°©ë¬¸íšŸìˆ˜/ì¼ìˆ˜ (APP, PC, ARS) ('1íšŒ ì´ìƒ'â†’0, '10íšŒ ì´ìƒ'â†’1, ...)
- ìº í˜ì¸ì ‘ì´‰ê±´ìˆ˜/ì¼ìˆ˜ (ë²”ìœ„ë³„ ë§¤í•‘)

### 4. í•œë„ê¸ˆì•¡ ê¸°ë°˜ íŒŒìƒë³€ìˆ˜

**Aë“±ê¸‰ ê¸°ì¤€ê°’ ì„¤ì •**:
- IQR ë°©ì‹ìœ¼ë¡œ ì´ìƒì¹˜ ì œê±° í›„ Aë“±ê¸‰ì˜ ìµœì†Œê°’ ë„ì¶œ
- B1M ê¸°ì¤€: ~170,344ì›, B2M ê¸°ì¤€: ~170,344ì›

**ì¹´ë“œì´ìš©í•œë„ê¸ˆì•¡_Aìˆ˜ì¤€ë³µí•©** ë³€ìˆ˜:
```python
def classify_dual_limit(row):
    b1 = row['ì¹´ë“œì´ìš©í•œë„ê¸ˆì•¡_B1M'] >= 170344
    b2 = row['ì¹´ë“œì´ìš©í•œë„ê¸ˆì•¡_B2M'] >= 170344
    if b1 and b2:
        return 2  # ë‘˜ ë‹¤ Aìˆ˜ì¤€
    elif b1 or b2:
        return 1  # í•˜ë‚˜ë§Œ Aìˆ˜ì¤€
    else:
        return 0  # ëª¨ë‘ ë¯¸ë§Œ
```

### 5. ì—…ì¢… ê¸°ë°˜ ì ìˆ˜ ì‹œìŠ¤í…œ â­ (ìƒê´€ê³„ìˆ˜ ê¸°ë°˜ ê°€ì¤‘ì )

ì„¸ê·¸ë¨¼íŠ¸ì™€ì˜ correlationì„ ë¶„ì„í•˜ì—¬ **A/B êµ¬ë¶„ ì ìˆ˜ ì„¤ê³„**:

**_nìˆœìœ„ì—…ì¢…_AB** (ìƒê´€ê³„ìˆ˜ -0.3030)
- 1ìˆœìœ„ ì—…ì¢…ì´ 'ì‡¼í•‘' â†’ +1
- 2ìˆœìœ„ ì—…ì¢…ì´ 'ì‚¬êµí™œë™' â†’ +1
- 2ìˆœìœ„ ì—…ì¢…ì´ 'ì˜ë£Œ' â†’ +1 (A/Bì—ì„œ ê°•í•¨)
- 3ìˆœìœ„ ì—…ì¢…ì´ 'ì‚¬êµí™œë™' or 'ì˜ë£Œ' â†’ +1
- 2/3ìˆœìœ„ ì—…ì¢…ì´ 'ì—†ìŒ' â†’ -1
- 2ìˆœìœ„ê°€ 'êµí†µ' or 'ë‚©ë¶€' â†’ -0.5

**_nìˆœìœ„ì‡¼í•‘ì—…ì¢…_AB** (ìƒê´€ê³„ìˆ˜ -0.3304)
- 1ìˆœìœ„ ì‡¼í•‘ì—…ì¢…ì´ 'ì˜¨ë¼ì¸' â†’ +1
- 2ìˆœìœ„ê°€ 'ë„ì†Œë§¤' â†’ +1
- 3ìˆœìœ„ê°€ 'ë§ˆíŠ¸' â†’ +1
- 1/2/3ìˆœìœ„ê°€ 'ì—†ìŒ' â†’ -1 (ë˜ëŠ” -0.5)

**_nìˆœìœ„êµí†µì—…ì¢…_AB, _nìˆœìœ„ì—¬ìœ ì—…ì¢…_AB, _nìˆœìœ„ë‚©ë¶€ì—…ì¢…_AB**ë„ ë™ì¼ ë°©ì‹

**ìµœì¢… ì—…ì¢… ì ìˆ˜**:
```python
df['_nìˆœìœ„ì—…ì¢…_AB_ì´í•©'] = (
    df['_nìˆœìœ„ì—…ì¢…_AB'] +          # ê¸°ë³¸ ì—…ì¢…
    df['_nìˆœìœ„ì‡¼í•‘ì—…ì¢…_AB'] +      # ì‡¼í•‘ ì„¸ë¶€
    df['_nìˆœìœ„êµí†µì—…ì¢…_AB'] +      # êµí†µ ì„¸ë¶€
    df['_nìˆœìœ„ì—¬ìœ ì—…ì¢…_AB'] +      # ì—¬ìœ  ì„¸ë¶€
    df['_nìˆœìœ„ë‚©ë¶€ì—…ì¢…_AB']        # ë‚©ë¶€ ì„¸ë¶€
)
```
ìµœê³  ìƒê´€ê³„ìˆ˜: **-0.3927** (4ê°€ì§€ ì¡°í•©)

### 6. ì´ìš©ê¸ˆì•¡ëŒ€ ì ìˆ˜
```python
amount_mapping = {
    '01.100ë§Œì›+': 18,
    '02.50ë§Œì›+': 5,
    '03.30ë§Œì›+': 2,
    '04.10ë§Œì›+': 2,
    '05.10ë§Œì›-': 1,
    '09.ë¯¸ì‚¬ìš©': 1
}
df['ì´ìš©ê¸ˆì•¡ëŒ€_ì ìˆ˜'] = df['ì´ìš©ê¸ˆì•¡ëŒ€'].map(amount_mapping)
```
ìƒê´€ê³„ìˆ˜: **-0.6026** (ê°€ì¥ ê°•ë ¥í•œ ë³€ìˆ˜ ì¤‘ í•˜ë‚˜)

### 7. ì´ìš© ì—¬ë¶€ ì´ì§„ ë³€ìˆ˜
ê° ìƒí’ˆë³„ ìµœì¢…ì´ìš©ì¼ì â†’ ì´ì§„ ë³€ìˆ˜ë¡œ ë³€í™˜:
- ê¸°ë³¸, ì‹ íŒ, CA, ì¹´ë“œë¡ , ì²´í¬, ì¼ì‹œë¶ˆ, í• ë¶€ (ì´ 7ê°œ)
- ë‚ ì§œê°€ 10101(ë¯¸ì‚¬ìš©) â‰  1ì´ë©´ ì´ìš© (1/0)

### 8. ê±´ìˆ˜ë³„ í‰ê·  ì´ìš©ê¸ˆì•¡ (B0M ê¸°ì¤€)
```python
df['ê±´ìˆ˜ë³„í‰ê· ì´ìš©ê¸ˆì•¡_ì‹ ìš©_B0M'] = df['ì´ìš©ê¸ˆì•¡_ì‹ ìš©_B0M'] / df['ì´ìš©ê±´ìˆ˜_ì‹ ìš©_B0M']
```
ìƒí’ˆë³„ë¡œ ìƒì„±: ì‹ ìš©, ì‹ íŒ, ì¼ì‹œë¶ˆ, í• ë¶€(ë¬´ì´ì/ìœ ì´ì), CA, ì²´í¬, ì¹´ë“œë¡ 

### 9. ì—…ì¢…ë³„ ì´ ì´ìš©ê¸ˆì•¡
```python
df['ì‡¼í•‘_ì´ì´ìš©ê¸ˆì•¡'] = df[['ì‡¼í•‘_ë„ì†Œë§¤', 'ì‡¼í•‘_ë°±í™”ì ', ..., 'ì‡¼í•‘_ì˜¨ë¼ì¸']].sum(axis=1)
df['êµí†µ_ì´ì´ìš©ê¸ˆì•¡'] = df[['êµí†µ_ì£¼ìœ ', 'êµí†µ_ì •ë¹„', ..., 'êµí†µ_ì² ë„ë²„ìŠ¤']].sum(axis=1)
df['ì—¬ìœ _ì´ì´ìš©ê¸ˆì•¡'] = ...
df['ë‚©ë¶€_ì´ì´ìš©ê¸ˆì•¡'] = ...
```
- ìƒê´€ê³„ìˆ˜ 0.3 ì´ìƒë§Œ ì„ ë³„í•œ `0.3ì´ìƒ_ì´ì´ìš©ê¸ˆì•¡`ë„ ìƒì„±
- ì „ì²´ ì—…ì¢… í•©ê³„ `ì´ì´ìš©ê¸ˆì•¡_ì‡¼í•‘êµí†µì—¬ìœ ë‚©ë¶€`

### 10. **A/B êµ¬ë¶„ í•„ì‚´ê¸° íŒŒìƒë³€ìˆ˜** â­â­â­ (íŒ€ ì§ì ‘ ì„¤ê³„)

| ë³€ìˆ˜ëª… | ê³µì‹ | ì˜ë¯¸ | í•µì‹¬ íš¨ê³¼ |
|--------|------|------|----------|
| **ìš°ëŸ‰í›„ë³´_ì—¬ë¶€** | í•œë„ â‰¥ 50,000 | ê¸°ë³¸ ë¬¸í„±ê°’ | C/D/E 1ì°¨ í•„í„° |
| **ì‹¤ì§ˆì—¬ìœ í•œë„** | í•œë„ Ã— (1 - ì†Œì§„ìœ¨) | í˜„ê¸ˆ ì—¬ìœ ë„ | **ê°€ì¥ ê°•ë ¥í•¨** |
| **í•œë„ëŒ€ë¹„_ì†Œë¹„ì„±í–¥** | ì†Œì§„ìœ¨ / log(í•œë„) | ê³µê²©ì„± ì§€í‘œ | AëŠ” ë‚®ìŒ, BëŠ” ë†’ìŒ |
| **ì¥ê¸°ìš°ëŸ‰ê³ ê°** | (í•œë„ â‰¥ 100,000) AND (ì…íšŒ â‰¥ 120ê°œì›”) | ì¥ê¸° ì‹ ë¢°ë„ | ì•ˆì •ì  ê³ ê° ì‹ë³„ |
| **í´ë¦°ì‹ ìš©ì§€í‘œ** | (ì¹´ë“œë¡  12M = 0) AND (CA 12M = 0) | ì‹ ìš© ê±´ì „ì„± | **Bì™€ Aì˜ í•µì‹¬ ì°¨ì´** |
| **í• ë¶€ì˜ì¡´ì§€í‘œ** | í• ë¶€ì”ì•¡ > ì¼ì‹œë¶ˆì”ì•¡ | ê¸ˆìœµì••ë°•ë„ | í˜„ê¸ˆ ìœ ë™ì„± ë¶€ì¡± ì‹ í˜¸ |
| **ë¦¬ë³¼ë¹™_ì‚¬ìš©ì—¬ë¶€** | ë¦¬ë³¼ë¹™ ì´ì›”ê¸ˆ > 0 | ìê¸ˆì••ë°• ìƒíƒœ | ì‹¬ê°í•œ ìœ ë™ì„± ë¬¸ì œ |
| **ì”ì•¡_ê¸‰ì¦ì‹ í˜¸** | ì›”ê°„ ë³€ë™ìœ¨ > 0.5 | ë‹¨ê¸° ë¶€ì±„ ê¸‰ì¦ | ìœ„ê¸° ì‹ í˜¸ ê°ì§€ |
| **í˜œíƒ_ê³ ìˆ˜í˜œì—¬ë¶€** | ìˆ˜í˜œìœ¨ > í‰ê·  | ì²´ë¦¬í”¼ì»¤ ì„±í–¥ | í˜œíƒë§Œ ì·¨í•˜ëŠ” ê³ ê° |

---

## ğŸ¤– ëª¨ë¸ë§ (Model Building)

### 1. íŠ¹ì„± ì„ íƒ (Feature Selection)

**í”„ë¡œì„¸ìŠ¤**:
1. ì „ì²´ ë³€ìˆ˜ë¡œ XGBoost í•™ìŠµ
2. Feature Importance ì¶”ì¶œ
3. ìƒìœ„ Nê°œ ë³€ìˆ˜ ì„ íƒ (N=300, 350, 400, 450)

**ê²°ê³¼ ë¶„ì„** (ìš°ë¦¬ íŒ€):
| ë³€ìˆ˜ ê°œìˆ˜ | Public | Private | Gap | íŠ¹ì§• |
|:------:|:---:|:---:|:---:|------|
| 300ê°œ | 0.6805 | 0.6715 | 0.0090 | ê°€ì¥ ì•ˆì •ì  |
| 350ê°œ | 0.6862 | 0.6691 | 0.0172 | ë¶ˆì•ˆì • |
| 400ê°œ | 0.6926 | 0.6720 | 0.0206 | ê³µê²©ì  |
| **450ê°œ** | **0.6929** | **0.6748** | **0.0181** | **ìµœê³  ì„±ëŠ¥ & ì•ˆì •ì„±** â­ |

**ìµœì¢… ì„ íƒ**: **450ê°œ ë³€ìˆ˜** (Public/Private ëª¨ë‘ ì •ì , gap ê°ì†Œ)

### 2. í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬

**ë¬¸ì œ**: 
- A ë“±ê¸‰ ~5%, B ë“±ê¸‰ ~10%, C/D/E ë‚˜ë¨¸ì§€
- ì´ì§„ ë¶„ë¥˜ ë¶ˆê°€ëŠ¥, ë‹¤ì¤‘ ë¶„ë¥˜ì—ì„œ ì†Œìˆ˜ í´ë˜ìŠ¤ í•™ìŠµ ë¶€ì¡±

**í•´ê²° ë°©ì•ˆ**:

**â‘  SMOTE (Synthetic Minority Over-sampling Technique)**
```python
smote = SMOTE(sampling_strategy={
    0: 30000,   # A ë“±ê¸‰ 30,000ê°œë¡œ ì¦ê°€
    1: 30000,   # B ë“±ê¸‰ 30,000ê°œë¡œ ì¦ê°€
    2: 250000   # C ë“±ê¸‰ 250,000ê°œë¡œ ì¦ê°€
}, random_state=42)
X_resampled, y_resampled = smote.fit_resample(X_top450, y)
```
- ì†Œìˆ˜ í´ë˜ìŠ¤ì˜ í•©ì„± ìƒ˜í”Œ ìƒì„±
- ë‹¤ìˆ˜ í´ë˜ìŠ¤ëŠ” ê³„ì‚°ëŸ‰ ê³ ë ¤í•´ ì œí•œ

**â‘¡ Balanced Class Weight**
```python
weights = compute_class_weight(
    'balanced', 
    classes=np.unique(y), 
    y=y
)
# í´ë˜ìŠ¤ë³„ ê°€ì¤‘ì¹˜ ë§µí•‘í•˜ì—¬ model.fit()ì— ì „ë‹¬
sample_weights = pd.Series(y).map(class_weights)
```
- ì†Œìˆ˜ í´ë˜ìŠ¤ì— ë†’ì€ ê°€ì¤‘ì¹˜ ë¶€ì—¬
- ì†ì‹¤í•¨ìˆ˜ ê³„ì‚° ì‹œ ì˜í–¥ë„ ì¦ê°€

### 3. ì„¸ ê°€ì§€ ë¶€ìŠ¤íŒ… ëª¨ë¸ êµ¬ì¶•

#### â‘  XGBoost (ê¸°ë³¸ ì„¤ì •)
```python
xgb_model = XGBClassifier(
    objective='multi:softprob',      # ë‹¤ì¤‘ ë¶„ë¥˜ (í™•ë¥  ì¶œë ¥)
    num_class=5,
    eval_metric='mlogloss',          # ë‹¤ì¤‘ ë¶„ë¥˜ ì†ì‹¤í•¨ìˆ˜
    n_estimators=5000,               # ë°˜ë³µ íšŸìˆ˜
    tree_method='hist',              # íˆìŠ¤í† ê·¸ë¨ ê¸°ë°˜ í•™ìŠµ
    device='cuda',                   # GPU ê°€ì†
    random_state=42
)
```
- ê°•ë ¥í•œ ê¸°ë³¸ ë¶€ìŠ¤íŒ… ëª¨ë¸
- í›„ë³´ ëª¨ë¸ ì„ íƒ ê¸°ì¤€ (Feature Importance)

#### â‘¡ LightGBM (í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™” ì ìš©) â­
```python
lgb_model = LGBMClassifier(
    objective='multiclass',
    num_class=5,
    metric='multi_logloss',
    
    # Optunaë¡œ ìµœì í™”ëœ íŒŒë¼ë¯¸í„°ë“¤
    num_boost_round=3348,            # ë°˜ë³µ íšŸìˆ˜
    learning_rate=0.163,             # í•™ìŠµë¥ 
    num_leaves=260,                  # ë¦¬í”„ ë…¸ë“œ ìˆ˜
    max_depth=6,                     # ìµœëŒ€ íŠ¸ë¦¬ ê¹Šì´
    min_data_in_leaf=1200,           # ë¦¬í”„ë‹¹ ìµœì†Œ ìƒ˜í”Œ
    bagging_fraction=0.9,            # ë°°ê¹… ë¹„ìœ¨
    bagging_freq=4,                  # ë°°ê¹… ë¹ˆë„
    feature_fraction=0.8,            # í”¼ì²˜ ìƒ˜í”Œë§ ë¹„ìœ¨
    lambda_l1=4.46e-05,              # L1 ì •ê·œí™”
    lambda_l2=0.690,                 # L2 ì •ê·œí™”
    min_gain_to_split=0.394,         # ë¶„í•  ìµœì†Œ ì´ë“
    
    device='gpu',                    # GPU ê°€ì†
    gpu_platform_id=0,
    gpu_device_id=0
)
```

#### â‘¢ CatBoost (ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬ ìš°ìˆ˜)
```python
cat_model = CatBoostClassifier(
    task_type='GPU',
    devices='0',
    iterations=5000,                 # ë°˜ë³µ íšŸìˆ˜
    class_weights=weights.tolist(),  # í´ë˜ìŠ¤ ê°€ì¤‘ì¹˜
    random_state=42,
    verbose=0
)
```
- ë²”ì£¼í˜• ë³€ìˆ˜ ìë™ ì²˜ë¦¬
- `íšŒì›_ì´ìš©ê°€ëŠ¥_ì ìˆ˜` ê°™ì€ ìˆœì„œí˜• ë³€ìˆ˜ì— ê°•í•¨

### 4. ëª¨ë¸ í•™ìŠµ

```python
# ë°ì´í„° ì¤€ë¹„
train_df = pd.read_parquet('./train_data.parquet')
X = train_df[top450_features]
y = train_df["Segment"].map({'A':0, 'B':1, 'C':2, 'D':3, 'E':4})

# SMOTE ì˜¤ë²„ìƒ˜í”Œë§
X_resampled, y_resampled = SMOTE(...).fit_resample(X, y)
sample_weights = pd.Series(y_resampled).map(class_weights)

# ê° ëª¨ë¸ í•™ìŠµ (ê²€ì¦ì…‹ ì—†ì´ ì „ì²´ ë°ì´í„° ì‚¬ìš©)
xgb_model.fit(X_resampled, y_resampled, sample_weight=sample_weights)
lgb_model.fit(X_resampled, y_resampled, sample_weight=sample_weights)
cat_model.fit(X_resampled, y_resampled)  # catì€ ë‚´ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬
```

---

## ğŸ¯ íŒŒì¸íŠœë‹ (Hyperparameter Optimization)

### LightGBM Optuna ìµœì í™”

Optuna í”„ë ˆì„ì›Œí¬ë¡œ ë‹¤ìŒ íŒŒë¼ë¯¸í„° íƒìƒ‰:

**ìµœì í™” ëŒ€ìƒ íŒŒë¼ë¯¸í„°**:
```python
def objective(trial):
    params = {
        'num_boost_round': trial.suggest_int('num_boost_round', 1000, 5000, step=500),
        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.3),
        'num_leaves': trial.suggest_int('num_leaves', 20, 300, step=10),
        'max_depth': trial.suggest_int('max_depth', 3, 15),
        'min_data_in_leaf': trial.suggest_int('min_data_in_leaf', 100, 2000, step=100),
        'bagging_fraction': trial.suggest_float('bagging_fraction', 0.5, 1.0),
        'bagging_freq': trial.suggest_int('bagging_freq', 1, 10),
        'feature_fraction': trial.suggest_float('feature_fraction', 0.5, 1.0),
        'lambda_l1': trial.suggest_float('lambda_l1', 1e-8, 10.0, log=True),
        'lambda_l2': trial.suggest_float('lambda_l2', 1e-8, 10.0, log=True),
        'min_gain_to_split': trial.suggest_float('min_gain_to_split', 0.0, 1.0),
    }
    # ëª¨ë¸ í•™ìŠµ ë° ê²€ì¦ ì ìˆ˜ ë°˜í™˜
    ...
```

**ìµœì í™” ê²°ê³¼**:
```python
lgb_model = LGBMClassifier(
    num_boost_round=3348,
    learning_rate=0.16304239034369372,
    num_leaves=260,
    max_depth=6,
    min_data_in_leaf=1200,
    bagging_fraction=0.8999999999999999,
    bagging_freq=4,
    feature_fraction=0.8,
    lambda_l1=4.4610495762623494e-05,
    lambda_l2=0.6898684039866835,
    min_gain_to_split=0.3944497642389666
)
```

---

## ğŸ“ˆ ëª¨ë¸ í‰ê°€ (Model Evaluation)

### Soft Voting ì•™ìƒë¸”

**ìµœì¢… ì˜ˆì¸¡ ë°©ì‹**:
```python
# ê° ëª¨ë¸ë³„ ì˜ˆì¸¡ í™•ë¥  ì‚°ì¶œ
proba_xgb = xgb_model.predict_proba(X_test)      # (n_samples, 5)
proba_lgb = lgb_model.predict(X_test)             # (n_samples, 5)
proba_cat = cat_model.predict_proba(X_test)       # (n_samples, 5)

# Soft Voting (í™•ë¥  ê°€ì¤‘ í‰ê· )
ensemble_proba = (0.4 * proba_xgb) + 
                 (0.3 * proba_lgb) + 
                 (0.3 * proba_cat)

# ìµœì¢… ì˜ˆì¸¡ (ê°€ì¥ ë†’ì€ í™•ë¥ ì˜ í´ë˜ìŠ¤)
ensemble_preds = np.argmax(ensemble_proba, axis=1)
```

**ê°€ì¤‘ì¹˜ ì„¤ì • ê·¼ê±°**:
- **XGBoost (0.4)**: Feature Importance ê¸°ì¤€ ì„ íƒ, ì¼ë°˜ì„± ìš°ìˆ˜
- **LightGBM (0.3)**: Optuna ìµœì í™”ë¡œ ì •êµí•œ í•™ìŠµ
- **CatBoost (0.3)**: ë²”ì£¼í˜• ë³€ìˆ˜ ì²˜ë¦¬ ìš°ìˆ˜, ì•™ìƒë¸” ë‹¤ì–‘ì„± ì¦ëŒ€

### ìµœì¢… ì„±ëŠ¥ (ìš°ë¦¬ íŒ€)

#### ë³€ìˆ˜ ê°œìˆ˜ë³„ ì„±ëŠ¥ ë¹„êµ
| ë³€ìˆ˜ ê°œìˆ˜ | Public ì ìˆ˜ | Private ì ìˆ˜ | ì ìˆ˜ í¸ì°¨ (Gap) | ë¹„ê³  |
|:------:|:-------:|:--------:|:-----:|------|
| 300ê°œ | 0.6805 | 0.6715 | 0.0090 | **ê°€ì¥ ì•ˆì •ì ** |
| 350ê°œ | 0.6862 | 0.6691 | 0.0172 | ì•ˆì •ì„± í•˜ë½ |
| 400ê°œ | 0.6926 | 0.6720 | 0.0206 | ê³µê²©ì„± ì¦ê°€ |
| **450ê°œ** | **0.6929** | **0.6748** | **0.0181** | **ìµœê³  ì„±ëŠ¥ & ì•ˆì •ì„±** â­ |

#### ì„±ëŠ¥ ë¶„ì„

**300ê°œ ë³€ìˆ˜**:
- Public/Private ì ìˆ˜ í¸ì°¨ **0.0090** (= ìµœì†Œ)
- ëª¨ë¸ì˜ ê³¼ì í•©ì´ ê±°ì˜ ì—†ìŒ
- ë³€ìˆ˜ë¥¼ ë§ì´ ì¤„ì—¬ ë…¸ì´ì¦ˆ íš¨ê³¼ì  ì–µì œ
- ë‹¤ë§Œ ì „ì²´ ì ìˆ˜ëŠ” ë‹¤ë¥¸ ëª¨ë¸ë³´ë‹¤ ë‚®ìŒ

**350ê°œ ë³€ìˆ˜**:
- 300ê°œ ëŒ€ë¹„ Public ì ìˆ˜ ìƒìŠ¹
- í•˜ì§€ë§Œ Private ì ìˆ˜ í•˜ë½ (ì˜¤ë²„í”¼íŒ… ì‹ í˜¸)
- í¸ì°¨ 0.0172ë¡œ ì¦ê°€ â†’ ë¶ˆì•ˆì •

**400ê°œ ë³€ìˆ˜** (2ë“± ì½”ë“œ ìµœê³ ì ):
- 2ë“± íŒŒì¼ ìµœê³  ì„±ëŠ¥ ë‹¬ì„± (Public 0.6983)
- ìš°ë¦¬íŒ€ì€ 300ê°œë¶€í„° ì‹œì‘í•´ 400ê°œê¹Œì§€ ì ìˆ˜ ìƒìŠ¹ì„¸
- í¸ì°¨ 0.0206ìœ¼ë¡œ ìµœì•… (ê°€ì¥ ì‹¬í•œ ì˜¤ë²„í”¼íŒ…)

**450ê°œ ë³€ìˆ˜** (ìš°ë¦¬íŒ€ ìµœê³ ì ) â­:
- Public: 0.6929 (ë§¤ìš° ìš°ìˆ˜)
- Private: 0.6748 (ë†’ì€ ì¼ë°˜í™”)
- **í¸ì°¨: 0.0181 (400ê°œë³´ë‹¤ ê°ì†Œ!)** â† í•µì‹¬
- 450ê°œ ë³€ìˆ˜ì˜ ì¶”ê°€ 50ê°œê°€ ë…¸ì´ì¦ˆë¥¼ ì–µì œí•˜ë©´ì„œ ì‹ í˜¸ ê°•í™”
- **ê°€ì¥ ìš°ìˆ˜í•œ ìŠ¤ìœ„íŠ¸ìŠ¤íŒŸ(Sweet Spot)** ë‹¬ì„±

#### í˜¼ë™í–‰ë ¬ (Confusion Matrix) ë¶„ì„
- **A, B ë“±ê¸‰**: ì¶©ë¶„íˆ êµ¬ë¶„ ê°€ëŠ¥ (í´ë˜ìŠ¤ ê°€ì¤‘ì¹˜ & SMOTE íš¨ê³¼)
- **C ë“±ê¸‰**: ì¤‘ê°„ êµ¬ê°„ìœ¼ë¡œ ì¸í•œ ë‹¤ì†Œì˜ í˜¼ë™ (ì˜ˆìƒëŒ€ë¡œ)
- **D, E ë“±ê¸‰**: ë†’ì€ ì •í™•ë„ (ë°ì´í„° ì¶©ë¶„)

---

## ğŸ“Œ í•µì‹¬ ì„±ê³µ ìš”ì†Œ

### 1. **ë„ë©”ì¸ ê¸°ë°˜ íŠ¹ì„± ê³µí•™** â­â­â­
- ê¸ˆìœµ ë„ë©”ì¸ ì§€ì‹ì„ í™œìš©í•œ 50+ íŒŒìƒë³€ìˆ˜ ìƒì„±
- ì—…ì¢… ê¸°ë°˜ ì ìˆ˜ ì‹œìŠ¤í…œ ì„¤ê³„ (5ê°€ì§€ ë¶„ì•¼)
- A/B êµ¬ë¶„ í•„ì‚´ê¸° ë³€ìˆ˜ (ì‹¤ì§ˆì—¬ìœ í•œë„, í´ë¦°ì‹ ìš©ì§€í‘œ ë“±)
- CatBoostê°€ `íšŒì›_ì´ìš©ê°€ëŠ¥_ì ìˆ˜` ë“±ì„ ë§¤ìš° ì¤‘ì‹œ

### 2. **ë°ì´í„° ë¶ˆê· í˜•ì— ëŒ€í•œ ë‹¤ì¸µ í•´ê²°**
- **SMOTE**: ì†Œìˆ˜ í´ë˜ìŠ¤ í•©ì„± ìƒ˜í”Œ ìƒì„±
- **Balanced Class Weight**: ì†ì‹¤í•¨ìˆ˜ì—ì„œ ê°€ì¤‘ì¹˜ ë¶€ì—¬
- ì´ì¤‘ ì „ëµìœ¼ë¡œ A/B ë“±ê¸‰ ì¶©ë¶„íˆ í•™ìŠµ ê°€ëŠ¥

### 3. **ì•™ìƒë¸” ë°©ì‹ì˜ ìµœì  ì¡°í•©**
- 3ê°€ì§€ ë¶€ìŠ¤íŒ… ëª¨ë¸ (XGB, LGB, CAT)ì˜ ê°•ì  í™œìš©
- Soft Votingìœ¼ë¡œ í™•ë¥  ê¸°ë°˜ íˆ¬í‘œ
- ê°€ì¤‘ì¹˜ (0.4, 0.3, 0.3) ì„¤ì •ìœ¼ë¡œ ìµœì  ì„±ëŠ¥ ë‹¬ì„±

### 4. **íŠ¹ì„± ì„ íƒì˜ ì •ë°€ì„±**
- 450ê°œ ë³€ìˆ˜ì—ì„œ ì‹ í˜¸/ë…¸ì´ì¦ˆ ìµœì  ê· í˜•
- 300ê°œ(ì•ˆì •) vs 450ê°œ(ì„±ëŠ¥) ì‚¬ì´ì˜ ì™„ë²½í•œ ì¤‘ê°„ì§€ì 
- Private í¸ì°¨ ê°ì†Œë¡œ ì¼ë°˜í™” ëŠ¥ë ¥ ì…ì¦

### 5. **í•˜ì´í¼íŒŒë¼ë¯¸í„° ìµœì í™”**
- Optunaë¥¼ í†µí•œ LightGBM ì •êµí•œ íŒŒë¼ë¯¸í„° íƒìƒ‰
- GPU ê°€ì†ìœ¼ë¡œ ë¹ ë¥¸ ì‹¤í—˜ ì‚¬ì´í´

### 6. **GPU í™œìš©**
- XGBoost, LightGBM, CatBoost ëª¨ë‘ GPU ê°€ì† (CUDA)
- ì½œë¡œë‹ˆ ê·œëª¨ì˜ ëŒ€ìš©ëŸ‰ ë°ì´í„° ë¹ ë¥´ê²Œ ì²˜ë¦¬

---

## ğŸ† ìµœì¢… ì œì¶œ ê²°ê³¼

**ìµœì¢… ì œì¶œ ëª¨ë¸**: 450ê°œ ë³€ìˆ˜ ê¸°ë°˜ Soft Voting ì•™ìƒë¸”
- **Public ì ìˆ˜**: 0.6929
- **Private ì ìˆ˜**: 0.6748
- **ì ìˆ˜ í¸ì°¨**: 0.0181 (ì•ˆì •ì„± ìš°ìˆ˜)

**ê²½ì§„ëŒ€íšŒ ìˆœìœ„ ì´ë ¥**:
- 2ë“± íŒŒì¼ ê¸°ì¤€ ì ìˆ˜ ë¹„êµ: ìš°ë¦¬íŒ€ 450ê°œ ë³€ìˆ˜ ëª¨ë¸ì´ ë†’ì€ ì•ˆì •ì„± í™•ë³´
- Public ì ìˆ˜ëŠ” 2ë“± íŒŒì¼(400ê°œ ë³€ìˆ˜, 0.6983)ì— ê·¼ì ‘í•˜ë©´ì„œë„ Private ì ìˆ˜ ìš°ìˆ˜

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ
- [XGBoost ê³µì‹ ë¬¸ì„œ](https://xgboost.readthedocs.io/)
- [LightGBM ê³µì‹ ë¬¸ì„œ](https://lightgbm.readthedocs.io/)
- [CatBoost ê³µì‹ ë¬¸ì„œ](https://catboost.ai/)
- [Optuna ê³µì‹ ë¬¸ì„œ](https://optuna.readthedocs.io/)

### ì•™ìƒë¸” í•™ìŠµ
- Soft Voting: í™•ë¥  ê¸°ë°˜ íˆ¬í‘œë¡œ ëª¨ë¸ì˜ ê°•ì  í™œìš©
- Hard Voting vs Soft Voting: í™•ë¥  ê¸°ë°˜ì´ ì¼ë°˜ì ìœ¼ë¡œ ìš°ìˆ˜

---

## ğŸ“ ë¼ì´ì„ ìŠ¤
ì´ í”„ë¡œì íŠ¸ëŠ” [LICENSE](LICENSE) íŒŒì¼ì— ë”°ë¦…ë‹ˆë‹¤.
